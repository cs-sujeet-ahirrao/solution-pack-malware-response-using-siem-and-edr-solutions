{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Investigate Malware Response (Splunk\/QRadar\/FortiEDR)",
    "aliasName": null,
    "tag": null,
    "description": "Investigates malware alert by checking if any malicious indicator found on the endpoint and then performs hunt for malicious indicator to block the same on firewall. Also performs a full scan of endpoint.",
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1646767367,
    "collection": "\/api\/3\/workflow_collections\/67ab2b27-c637-4980-abf4-4c5bd18c93b9",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/c245335d-126a-41d7-a0f6-29bccf17c20a",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "alertID": "{{vars.input.records[0].id}}",
                "alertIRI": "{{vars.input.records[0]['@id']}}",
                "sourceIP": "{{vars.input.records[0].sourceIp}}",
                "alertRawData": "{{vars.input.records[0].sourcedata}}",
                "useMockOutput": "true",
                "maliciousReputationIRI": "{{\"IndicatorReputation\" | picklist(\"Malicious\", \"@id\")}}"
            },
            "status": null,
            "top": "165",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "10316952-94ff-4218-a84f-acec8ad2fa7b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Suspicious Endpoint Analysis",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Manually Analyze Suspicious Endpoint",
                        "description": "A suspicious malware activity has been detection for the following endpoint, Refer the below details:\n<br \/>\n**Alert ID**  - {{vars.alertID}}\n**Source IP** - {{vars.sourceIP}}\n<br \/>\nThere is no malicious indicators found for this alert. \n<br \/>\nPlease investigate this manually to detemine if this is malicious activity.",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Malicious",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/862206b3-f9f9-4170-b006-85425979e3f4"
                        },
                        {
                            "option": "Non Malicious",
                            "step_iri": "\/api\/3\/workflow_steps\/d161ef96-0857-4c66-8f76-d500c79db9ed"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "1110",
            "left": "135",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "3b816510-efc4-4a95-bce7-651a2acc8b06"
        },
        {
            "@type": "WorkflowStep",
            "name": "Investigation Summary",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Investigation Summary",
                        "description": "Please review the following investigation summary of malicious indicators.<\/br>\n\u00a0{% for summary in vars.steps.Hunt_Malicious_Indicator | sort(attribute='indicator_type') %}{{summary.analysis_summary}}\n{% endfor %}\n<br \/>\nPlease provide your approval to block the indicator on the firewall.",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Block",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/a422aaf1-0fc7-4580-a65d-2858d25b5072"
                        },
                        {
                            "option": "Do Not Block",
                            "step_iri": "\/api\/3\/workflow_steps\/f12e721b-0e85-4ef4-96ad-bf693101d69b"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "1785",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "be0dab73-2be2-443e-be23-82aaa63d7009"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Malicious Indicator",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "id",
                            "value": "{{vars.alertID}}",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ],
                    "__selectFields": [
                        "indicators"
                    ]
                },
                "module": "alerts?$limit=30000&$relationships=true",
                "checkboxFields": true,
                "step_variables": {
                    "maliciousIndicatorsList": "{{vars.result[0].indicators | json_query(\"[? reputation == '\"+vars.maliciousReputationIRI+\"']\")}}"
                }
            },
            "status": null,
            "top": "705",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "uuid": "8d6bd56a-c945-400e-9ef0-1ffa4022c375"
        },
        {
            "@type": "WorkflowStep",
            "name": "Comment for Endpoint Not Found",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.alertIRI}}",
                    "people": [],
                    "content": "<p>Endpoint details with <em>IP address {{vars.source_ip}}<\/em> has not been found&nbsp;<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false,
                    "rawCommentData": "No Endpoint has been found for IP address {{vars.sourceIP}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "135",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "5b9ce9ab-810d-4be0-96f6-421abb94e3fc"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "d4325e94-11e8-4b15-a39b-2e33faf3dfdb",
                "title": "Investigate Malware Response (Splunk\/QRadar\/FortiEDR)",
                "resources": [
                    "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": [
                            {
                                "type": "object",
                                "field": "status",
                                "value": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                                    "itemValue": "Open"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "object",
                                "field": "type",
                                "value": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                                "_value": {
                                    "@id": "\/api\/3\/picklists\/0cbc2c31-c360-4770-b1e7-3653a8c24ead",
                                    "itemValue": "Malware"
                                },
                                "operator": "eq"
                            },
                            {
                                "type": "primitive",
                                "field": "source",
                                "value": "Splunk",
                                "operator": "eq",
                                "_operator": "eq"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": false
            },
            "status": null,
            "top": "30",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "uuid": "c245335d-126a-41d7-a0f6-29bccf17c20a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start Investigation",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<div>Investigating Potential {{vars.input.records[0].type.itemValue}} type Alert with following fields of interest:<\/div>\n<div>{% if vars.input.records[0].domain %}<strong>Domain:<\/strong> {{vars.input.records[0].domain -}}{% endif %}<\/div>\n<div>{% if vars.input.records[0].sourceIp %}<strong>SourceIP:<\/strong> {{ vars.input.records[0].sourceIp -}}{% endif %}<\/div>\n<div>{% if vars.input.records[0].destinationIp %}<strong>DestinationIP:<\/strong> {{vars.input.records[0].destinationIp -}}{% endif %}<\/div>\n<div>{% if vars.input.records[0].fileHash %}<strong>File Hash:<\/strong> {{vars.input.records[0].fileHash -}}{% endif %}<\/div>\n<div>{% if vars.input.records[0].computerName %}<strong>ComputerName:<\/strong> {{vars.input.records[0].computerName -}}{% endif %}<\/div>\n<div>{% if vars.input.records[0].processName %}<strong>Process:<\/strong> {{vars.input.records[0].processName -}}{% endif %}<\/div>\n<div>{% if vars.input.records[0].sourceProcess %}<strong>SourceProcess:<\/strong> {{vars.input.records[0].sourceProcess -}}{% endif %}<\/div>",
                    "records": ""
                },
                "resource": {
                    "status": "\/api\/3\/picklists\/758925e7-629c-46d8-89db-fb36f5fbe88a"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "12f1214f-5019-4090-b20f-8b7759c66ea4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Mark Alert as  Close",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<ul>\n<li>There are no malicious indicators found for this alert.<\/li>\n<li>Alert has been closed<\/li>\n<\/ul>",
                    "records": ""
                },
                "resource": {
                    "status": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.alertIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "d161ef96-0857-4c66-8f76-d500c79db9ed"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Close Alert",
                        "description": "An approval to block malicious indicators on the firewall has been denied.\n\nPlease provide your confirmation to close the alert.",
                        "inputVariables": [
                            {
                                "name": "closureReason",
                                "type": "string",
                                "label": "Closure Reason",
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "text",
                                "required": true,
                                "_expanded": true,
                                "moduleField": "closureReason",
                                "useRecordFieldDefault": true
                            },
                            {
                                "name": "closureNotes",
                                "type": "string",
                                "label": "Closure Notes",
                                "tooltip": "",
                                "dataType": "text",
                                "formType": "text",
                                "required": true,
                                "_expanded": true,
                                "moduleField": "closureNotes",
                                "useRecordFieldDefault": true
                            }
                        ]
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "owner_detail": {
                    "isAssigned": false
                },
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Close Alert",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/02d416e0-0ed7-4c9d-868d-720d6c4436ce"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "1920",
            "left": "660",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "f12e721b-0e85-4ef4-96ad-bf693101d69b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Comment For Malicious Indicator Investigation",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.alertIRI}}",
                    "people": [],
                    "content": "<p>Malicious indicators have been found in the alert<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "indicatorsList": "{{vars.maliciousIndicatorsList}}"
                }
            },
            "status": null,
            "top": "1110",
            "left": "495",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "531affed-d82c-409c-bd37-ef57bb451c86"
        },
        {
            "@type": "WorkflowStep",
            "name": "Hunt Malicious Indicator",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.indicatorsList}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "alert_iri": "{{vars.alertIRI}}",
                    "indicator_type": "{{(vars.item.typeofindicator | fromIRI).itemValue}}",
                    "indicator_value": "{{vars.item.value}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/2656cce7-c5ef-4998-9a93-c1c28f2b0b0b"
            },
            "status": null,
            "top": "1515",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "449dd931-8b04-4160-8584-9659aab63570"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Investigation Summary",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 248,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.input.records[0]['@id']}}",
                    "people": [],
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>&nbsp;{% for summary in vars.steps.Hunt_Malicious_Indicator | sort(attribute='indicator_type') %}{{summary.analysis_summary}}<br>{% endfor %}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1650",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "f475c00c-82b9-436c-bdf7-fd2df4629059"
        },
        {
            "@type": "WorkflowStep",
            "name": "Comment for Endpoint Found",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.alertIRI}}",
                    "people": [],
                    "content": "<p>Endpoint point has found for IP address {{vars.sourceIP}}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "588b216a-d65f-44ba-9f16-6047fdadbe04"
        },
        {
            "@type": "WorkflowStep",
            "name": "Found Malicious Indicator",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/531affed-d82c-409c-bd37-ef57bb451c86",
                        "condition": "{{ vars.maliciousIndicatorsList | length > 0 }}",
                        "step_name": "Comment For Malicious Indicator Investigation"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/cc3a2b4e-1b61-4986-8712-361ac156ff85",
                        "step_name": "Comment For No Malicious Indicator Found"
                    }
                ]
            },
            "status": null,
            "top": "840",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "e2c1bf30-9a3e-4e93-b147-c8ff087ea2d7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Block Indicators",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.maliciousIndicatorsList}}",
                    "__bulk": false,
                    "parallel": true,
                    "condition": ""
                },
                "arguments": {
                    "indicator_type": "{{vars.item.typeofindicator.itemValue}}",
                    "indicator_value": "{{vars.item.value}}",
                    "indicator_record_iri": "{{vars.item['@id']}}",
                    "indicator_block_reason": "Blocking Initiated as part of remediation process. Please refer Alert# {{vars.input.records[0].id}}"
                },
                "apply_async": true,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/1a1cac48-567a-4066-b0d1-c63457226f12"
            },
            "status": null,
            "top": "1920",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "a422aaf1-0fc7-4580-a65d-2858d25b5072"
        },
        {
            "@type": "WorkflowStep",
            "name": "Escalate Alert to Incident",
            "description": null,
            "arguments": {
                "arguments": {
                    "records": "[{{vars.input.records[0]}}]",
                    "severity": "{{('Severity' | picklist(vars.input.records[0].severity.itemValue))['@id']}}",
                    "incidentLead": "{{vars.input.records[0].assignedTo}}",
                    "incidentName": "Escalated {{vars.input.records[0].name}} Alert",
                    "incidentType": "{{\"IncidentType\" | picklist(\"Malware\", \"@id\")}}",
                    "incidentOwners": "",
                    "escalationReason": "Found Malicious Endpoint"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "\/api\/3\/workflows\/49160df7-9694-4451-9a15-41e79fdd3aa3"
            },
            "status": null,
            "top": "1380",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "uuid": "6680cc9a-7641-4d2b-b38f-9eee09b86f15"
        },
        {
            "@type": "WorkflowStep",
            "name": "Scan Endpoint",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Scan Endpoint",
                        "description": "A malicious indicators has been found on endpoint with IP address {{vars.sourceIP}}\n\nPlease perform a scan on the same and proceed once the scan is completed.\n",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Scan Completed",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/6680cc9a-7641-4d2b-b38f-9eee09b86f15"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "1245",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "862206b3-f9f9-4170-b006-85425979e3f4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Comment For No Malicious Indicator Found",
            "description": null,
            "arguments": {
                "resource": {
                    "type": {
                        "id": 247,
                        "@id": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "icon": null,
                        "uuid": "ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                        "@type": "Picklist",
                        "color": null,
                        "display": "Comment",
                        "@context": "\/api\/3\/contexts\/Picklist",
                        "listName": "\/api\/3\/picklist_names\/0841c1eb-a0a3-4abd-b29c-9f68e4d9b14f",
                        "itemValue": "Comment",
                        "orderIndex": 1
                    },
                    "alerts": "{{vars.alertIRI}}",
                    "people": [],
                    "content": "<p>Malicious indicators have not been found in the alert.<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "indicatorsList": "{{vars.steps.Get_Malicious_Indicator[0].indicators}}"
                }
            },
            "status": null,
            "top": "975",
            "left": "135",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "cc3a2b4e-1b61-4986-8712-361ac156ff85"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Endpoint Details",
            "description": null,
            "arguments": {
                "type": "DecisionBased",
                "input": {
                    "schema": {
                        "title": "Get Endpoint Details",
                        "description": "A alert has been generated for a suspected malware activity for the following endpoint:\n\n**IP Address:** {{vars.sourceIP}}\n<br\/>\nPlease get more details of an endpoint and confirm if details are found for the same\n",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "resources": "alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Found",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/588b216a-d65f-44ba-9f16-6047fdadbe04"
                        },
                        {
                            "option": "Not Found",
                            "step_iri": "\/api\/3\/workflow_steps\/5b9ce9ab-810d-4be0-96f6-421abb94e3fc"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                }
            },
            "status": null,
            "top": "435",
            "left": "310",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "uuid": "12b5fe60-1af1-49f1-a3de-036b36da18ff"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert Record",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "{{vars.input.records[0].tenant['@id']}}",
                    "content": "<p>The Alert has been closed.<\/p>",
                    "records": ""
                },
                "resource": {
                    "status": "\/api\/3\/picklists\/fac53e73-8d16-4189-98d5-95fbd1555232",
                    "closureNotes": "{{vars.steps.Close_Alert.input.closureNotes}}",
                    "closureReason": "{{vars.steps.Close_Alert.input.closureReason}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "2055",
            "left": "485",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "02d416e0-0ed7-4c9d-868d-720d6c4436ce"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Start Detection Timer",
            "targetStep": "\/api\/3\/workflow_steps\/12f1214f-5019-4090-b20f-8b7759c66ea4",
            "sourceStep": "\/api\/3\/workflow_steps\/10316952-94ff-4218-a84f-acec8ad2fa7b",
            "label": null,
            "isExecuted": false,
            "uuid": "b382b7d0-224d-434b-a978-5a92eea2ec12"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> CHANGE Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/10316952-94ff-4218-a84f-acec8ad2fa7b",
            "sourceStep": "\/api\/3\/workflow_steps\/c245335d-126a-41d7-a0f6-29bccf17c20a",
            "label": null,
            "isExecuted": false,
            "uuid": "e945b095-e129-4f1d-9340-eb87916071b4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Suspicious Endpoint Analysis -> Close the Alert",
            "targetStep": "\/api\/3\/workflow_steps\/d161ef96-0857-4c66-8f76-d500c79db9ed",
            "sourceStep": "\/api\/3\/workflow_steps\/3b816510-efc4-4a95-bce7-651a2acc8b06",
            "label": "Non Malicious",
            "isExecuted": false,
            "uuid": "c9ca6e00-78b2-49f8-bd55-932dade55950"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Found Malicious Indicator -> Add Note For Indicator Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/531affed-d82c-409c-bd37-ef57bb451c86",
            "sourceStep": "\/api\/3\/workflow_steps\/e2c1bf30-9a3e-4e93-b147-c8ff087ea2d7",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "05724081-3731-4875-b275-3d0e14f22cce"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Malicious Indicator -> Found Malicious Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/e2c1bf30-9a3e-4e93-b147-c8ff087ea2d7",
            "sourceStep": "\/api\/3\/workflow_steps\/8d6bd56a-c945-400e-9ef0-1ffa4022c375",
            "label": null,
            "isExecuted": false,
            "uuid": "231d070a-b22c-4123-b228-cd48cfda9765"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note for Endpoint Found -> Get Malicious Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/8d6bd56a-c945-400e-9ef0-1ffa4022c375",
            "sourceStep": "\/api\/3\/workflow_steps\/588b216a-d65f-44ba-9f16-6047fdadbe04",
            "label": null,
            "isExecuted": false,
            "uuid": "b33ae93e-8d8e-4837-8468-42d1d3d6b6f3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Found Malicious Indicator -> Add Note For No Malicious Indicator Investigation",
            "targetStep": "\/api\/3\/workflow_steps\/cc3a2b4e-1b61-4986-8712-361ac156ff85",
            "sourceStep": "\/api\/3\/workflow_steps\/e2c1bf30-9a3e-4e93-b147-c8ff087ea2d7",
            "label": "No",
            "isExecuted": false,
            "uuid": "c69c4a12-4e82-4e99-ab10-e56bdf0f8db2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Note For No Malicious Indicator Investigation -> Suspicious Endpoint Analysis",
            "targetStep": "\/api\/3\/workflow_steps\/3b816510-efc4-4a95-bce7-651a2acc8b06",
            "sourceStep": "\/api\/3\/workflow_steps\/cc3a2b4e-1b61-4986-8712-361ac156ff85",
            "label": null,
            "isExecuted": false,
            "uuid": "e94263a0-4df8-46e1-9367-d1749b3b0428"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Hunt Malicious Indicator -> Add Investigation Summary",
            "targetStep": "\/api\/3\/workflow_steps\/f475c00c-82b9-436c-bdf7-fd2df4629059",
            "sourceStep": "\/api\/3\/workflow_steps\/449dd931-8b04-4160-8584-9659aab63570",
            "label": null,
            "isExecuted": false,
            "uuid": "b217ae5f-073d-405c-b3ae-53337f0f331d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Investigation Summary -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/f12e721b-0e85-4ef4-96ad-bf693101d69b",
            "sourceStep": "\/api\/3\/workflow_steps\/be0dab73-2be2-443e-be23-82aaa63d7009",
            "label": "Do Not Block",
            "isExecuted": false,
            "uuid": "8c7ba275-c5ed-4eec-ae37-fcbbcb14851a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Close Alert -> Close Alert Record",
            "targetStep": "\/api\/3\/workflow_steps\/02d416e0-0ed7-4c9d-868d-720d6c4436ce",
            "sourceStep": "\/api\/3\/workflow_steps\/f12e721b-0e85-4ef4-96ad-bf693101d69b",
            "label": "Close Alert",
            "isExecuted": false,
            "uuid": "0860f607-ffc0-4012-986d-c0cb78d3ad53"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Investigation Summary -> Block Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/a422aaf1-0fc7-4580-a65d-2858d25b5072",
            "sourceStep": "\/api\/3\/workflow_steps\/be0dab73-2be2-443e-be23-82aaa63d7009",
            "label": "Block",
            "isExecuted": false,
            "uuid": "4dd419d8-fd76-4acd-ac37-bc933f67a402"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Details for Endpoint -> Add Note for Endpoint Found",
            "targetStep": "\/api\/3\/workflow_steps\/588b216a-d65f-44ba-9f16-6047fdadbe04",
            "sourceStep": "\/api\/3\/workflow_steps\/12b5fe60-1af1-49f1-a3de-036b36da18ff",
            "label": "Found",
            "isExecuted": false,
            "uuid": "8f42c84e-239a-427b-b2c1-8bb86c494ed0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Details for Endpoint -> Add Note for Endpoint not Found",
            "targetStep": "\/api\/3\/workflow_steps\/5b9ce9ab-810d-4be0-96f6-421abb94e3fc",
            "sourceStep": "\/api\/3\/workflow_steps\/12b5fe60-1af1-49f1-a3de-036b36da18ff",
            "label": "Not Found",
            "isExecuted": false,
            "uuid": "d5993786-5e8e-4513-bbf6-8f930ec69e2a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Comment for Endpoint Not Found -> Get Malicious Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/8d6bd56a-c945-400e-9ef0-1ffa4022c375",
            "sourceStep": "\/api\/3\/workflow_steps\/5b9ce9ab-810d-4be0-96f6-421abb94e3fc",
            "label": null,
            "isExecuted": false,
            "uuid": "3bcd4727-e39f-4c8d-875e-b5e4c61987df"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Investigation Summary -> Investigation Summary",
            "targetStep": "\/api\/3\/workflow_steps\/be0dab73-2be2-443e-be23-82aaa63d7009",
            "sourceStep": "\/api\/3\/workflow_steps\/f475c00c-82b9-436c-bdf7-fd2df4629059",
            "label": null,
            "isExecuted": false,
            "uuid": "ef48b01b-abe2-4189-8168-474d8210874e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Block Indicators -> Close Alert Record",
            "targetStep": "\/api\/3\/workflow_steps\/02d416e0-0ed7-4c9d-868d-720d6c4436ce",
            "sourceStep": "\/api\/3\/workflow_steps\/a422aaf1-0fc7-4580-a65d-2858d25b5072",
            "label": null,
            "isExecuted": false,
            "uuid": "4c37bc0d-532d-4ece-8a67-6b62ea616fc0"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Comment For Malicious Indicator Investigation -> Scan Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/862206b3-f9f9-4170-b006-85425979e3f4",
            "sourceStep": "\/api\/3\/workflow_steps\/531affed-d82c-409c-bd37-ef57bb451c86",
            "label": null,
            "isExecuted": false,
            "uuid": "43ec73b4-f088-4a38-a7e4-fe9dffede822"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Suspicious Endpoint Analysis -> Scan Endpoint",
            "targetStep": "\/api\/3\/workflow_steps\/862206b3-f9f9-4170-b006-85425979e3f4",
            "sourceStep": "\/api\/3\/workflow_steps\/3b816510-efc4-4a95-bce7-651a2acc8b06",
            "label": "Malicious",
            "isExecuted": false,
            "uuid": "f6714f83-af0d-44a8-9100-b0babb0da003"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start Investigation -> Get Endpoint Details",
            "targetStep": "\/api\/3\/workflow_steps\/12b5fe60-1af1-49f1-a3de-036b36da18ff",
            "sourceStep": "\/api\/3\/workflow_steps\/12f1214f-5019-4090-b20f-8b7759c66ea4",
            "label": null,
            "isExecuted": false,
            "uuid": "1ace77e0-2706-49a4-8818-10460e493d5e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Scan Endpoint -> Escalate Alert to Incident",
            "targetStep": "\/api\/3\/workflow_steps\/6680cc9a-7641-4d2b-b38f-9eee09b86f15",
            "sourceStep": "\/api\/3\/workflow_steps\/862206b3-f9f9-4170-b006-85425979e3f4",
            "label": "Scan Completed",
            "isExecuted": false,
            "uuid": "32f98bdf-3591-4e0d-b7e8-43d244e86ce1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Escalate Alert to Incident -> Hunt Malicious Indicator",
            "targetStep": "\/api\/3\/workflow_steps\/449dd931-8b04-4160-8584-9659aab63570",
            "sourceStep": "\/api\/3\/workflow_steps\/6680cc9a-7641-4d2b-b38f-9eee09b86f15",
            "label": null,
            "isExecuted": false,
            "uuid": "328be838-6e8f-4e16-99d8-6de50740c9be"
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "ce8a4929-1c64-456f-bb76-f51be52f5f86",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "ManualTrigger"
    ]
}